<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Regression Rebels | Dual-Region Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; background-color: #f8fafc; transition: background-color 0.5s ease; }
        .glass-card { background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(10px); border: 1px solid rgba(226, 232, 240, 1); }
        .stat-card:hover { transform: translateY(-2px); transition: all 0.3s ease; }
        
        /* Region Themes */
        .theme-tn { --brand-primary: #059669; --brand-secondary: #064e3b; --accent: #ecfdf5; }
        .theme-us { --brand-primary: #2563eb; --brand-secondary: #1e3a8a; --accent: #eff6ff; }

        .gradient-bg { 
            background: linear-gradient(135deg, var(--brand-secondary) 0%, var(--brand-primary) 100%); 
            transition: all 0.5s ease;
        }
        
        .season-btn.active {
            background-color: var(--accent);
            border-color: var(--brand-primary);
            color: var(--brand-primary);
            font-weight: 700;
        }
        .chart-container { height: 160px; position: relative; }
        
        .region-tab.active {
            background-color: white;
            color: var(--brand-primary);
            box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1);
        }
        .btn-primary { background-color: var(--brand-primary); }
    </style>
</head>
<body class="text-slate-800 theme-tn" id="bodyTheme">

    <!-- Navigation -->
    <nav class="sticky top-0 z-50 bg-white border-b border-slate-200 px-6 py-3 flex justify-between items-center">
        <div class="flex items-center space-x-2">
            <div class="p-2 rounded-lg btn-primary transition-colors duration-500">
                <i class="fas fa-seedling text-white"></i>
            </div>
            <span class="text-xl font-bold tracking-tight text-slate-900">Regression Rebels</span>
        </div>
        
        <!-- Region Switcher -->
        <div class="flex items-center bg-slate-100 p-1 rounded-xl border border-slate-200">
            <button id="tabTN" onclick="switchRegion('TN')" class="region-tab active px-4 py-1.5 text-xs font-bold rounded-lg transition-all flex items-center gap-2">
                <span class="w-2 h-2 rounded-full bg-emerald-500"></span> Tamil Nadu
            </button>
            <button id="tabUS" onclick="switchRegion('US')" class="region-tab px-4 py-1.5 text-xs font-bold rounded-lg transition-all flex items-center gap-2 text-slate-500">
                <span class="w-2 h-2 rounded-full bg-blue-500"></span> US Corn Belt
            </button>
        </div>

        <div class="hidden md:flex space-x-6 text-sm font-medium text-slate-500">
            <a href="#overview" class="hover:text-emerald-600 transition">Metrics</a>
            <a href="#predict" class="hover:text-emerald-600 transition">Predictor</a>
        </div>
    </nav>

    <main class="max-w-7xl mx-auto p-4 md:p-6 space-y-6">
        
        <!-- Header Section -->
        <header id="overview" class="gradient-bg rounded-3xl p-6 md:p-10 text-white shadow-xl relative overflow-hidden">
            <div class="relative z-10 max-w-2xl">
                <div class="inline-flex items-center space-x-2 bg-white/10 px-3 py-1 rounded-full text-xs font-bold mb-4 backdrop-blur-sm border border-white/20">
                    <i class="fas fa-microchip"></i>
                    <span id="modelTag">XGBoost Architecture v2.4</span>
                </div>
                <h1 class="text-3xl md:text-5xl font-extrabold mb-3 leading-tight" id="mainTitle">Tamil Nadu Multi-Crop Prediction</h1>
                <p id="regionSub" class="text-white/80 text-base md:text-lg mb-8 leading-relaxed">
                    Optimizing food security with high-precision machine learning models.
                </p>
                
                <div class="flex flex-wrap gap-4">
                    <div class="bg-black/20 backdrop-blur-md rounded-2xl px-5 py-3 border border-white/10">
                        <p class="text-[10px] uppercase tracking-widest text-white/60 mb-1">RÂ² Accuracy Score</p>
                        <p id="statAcc" class="text-2xl font-bold tracking-tight">93.87%</p>
                    </div>
                    <div class="bg-black/20 backdrop-blur-md rounded-2xl px-5 py-3 border border-white/10">
                        <p class="text-[10px] uppercase tracking-widest text-white/60 mb-1">Error Margin (RMSE)</p>
                        <p id="statError" class="text-2xl font-bold tracking-tight">0.68</p>
                    </div>
                </div>
            </div>
            <i class="fas fa-chart-area absolute -bottom-10 -right-10 text-white/5 text-[20rem] rotate-12"></i>
        </header>

        <!-- Dynamic Insights Bar -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
            <div class="glass-card p-4 rounded-2xl flex items-center space-x-4">
                <div class="p-3 rounded-xl bg-amber-50 text-amber-600">
                    <i class="fas fa-lightbulb"></i>
                </div>
                <div>
                    <p class="text-[10px] text-slate-400 font-bold uppercase">Key Driver</p>
                    <p id="topDriver" class="text-sm font-bold">Annual Rainfall (TN)</p>
                </div>
            </div>
            <div class="glass-card p-4 rounded-2xl flex items-center space-x-4">
                <div class="p-3 rounded-xl bg-purple-50 text-purple-600">
                    <i class="fas fa-flask"></i>
                </div>
                <div>
                    <p class="text-[10px] text-slate-400 font-bold uppercase">Scientific Validation</p>
                    <p class="text-sm font-bold">P-Value < 0.001</p>
                </div>
            </div>
            <div class="glass-card p-4 rounded-2xl flex items-center space-x-4">
                <div class="p-3 rounded-xl bg-emerald-50 text-emerald-600" id="statusIcon">
                    <i class="fas fa-check-circle"></i>
                </div>
                <div>
                    <p class="text-[10px] text-slate-400 font-bold uppercase">Model Status</p>
                    <p class="text-sm font-bold">Validated & Production Ready</p>
                </div>
            </div>
        </div>

        <!-- Analytics Section -->
        <div id="analytics" class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <div class="glass-card p-6 rounded-3xl shadow-sm">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-sm font-bold flex items-center gap-2">
                        <i class="fas fa-history text-slate-400"></i> Historical Correlation
                    </h3>
                    <span id="chartSub" class="text-[10px] bg-slate-100 px-2 py-1 rounded font-bold text-slate-500 uppercase">Tamil Nadu Context</span>
                </div>
                <div class="chart-container">
                    <canvas id="yieldChart"></canvas>
                </div>
            </div>

            <div class="glass-card p-6 rounded-3xl shadow-sm">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-sm font-bold flex items-center gap-2">
                        <i class="fas fa-fingerprint text-slate-400"></i> Feature Importance
                    </h3>
                    <span class="text-[10px] text-slate-400">Model Sensitivity</span>
                </div>
                <div class="chart-container">
                    <canvas id="featureChart"></canvas>
                </div>
            </div>
        </div>

        <!-- Predictor Simulator -->
        <div id="predict" class="glass-card p-8 rounded-[2.5rem] shadow-sm border border-slate-200">
            <div class="flex flex-col md:flex-row md:items-center justify-between gap-4 mb-8">
                <div class="flex items-center space-x-3">
                    <div class="w-1.5 h-8 btn-primary rounded-full transition-colors duration-500"></div>
                    <h2 class="text-2xl font-extrabold tracking-tight">Yield Predictor <span id="simRegion" class="text-slate-400">(Tamil Nadu)</span></h2>
                </div>
                <div class="bg-slate-50 px-4 py-2 rounded-xl border border-slate-100 flex items-center gap-2">
                    <i class="fas fa-info-circle text-slate-400 text-xs"></i>
                    <p class="text-[10px] text-slate-500 font-medium">Input area and climate metrics to predict the yield ratio.</p>
                </div>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-10">
                <!-- Col 1: Crop & Climate -->
                <div class="space-y-6">
                    <div>
                        <label class="block text-xs font-bold text-slate-400 mb-3 uppercase tracking-widest">Target Crop</label>
                        <select id="cropType" class="w-full bg-slate-50 border border-slate-200 rounded-2xl px-4 py-3 text-sm font-semibold outline-none focus:ring-2 focus:ring-emerald-500 transition-all">
                            <!-- Populated by JS -->
                        </select>
                    </div>
                    <div>
                        <label id="rainLabel" class="block text-xs font-bold text-slate-400 mb-3 uppercase tracking-widest">Annual Rainfall (mm)</label>
                        <input type="range" id="rainfallInput" min="400" max="2500" value="1100" class="w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-emerald-600">
                        <div class="flex justify-between text-[11px] text-slate-500 mt-3 font-medium">
                            <span>MIN</span>
                            <span id="rainfallVal" class="font-bold text-slate-900 bg-slate-100 px-3 py-1 rounded-full">1100mm</span>
                            <span>MAX</span>
                        </div>
                    </div>
                </div>

                <!-- Col 2: Land & Timing -->
                <div class="space-y-6">
                    <div>
                        <label class="block text-xs font-bold text-slate-400 mb-3 uppercase tracking-widest">Cultivated Area (Hectares)</label>
                        <input type="number" id="areaInput" value="50" class="w-full bg-slate-50 border border-slate-200 rounded-2xl px-4 py-3 text-sm font-semibold outline-none focus:ring-2 focus:ring-emerald-500">
                    </div>
                    <div id="seasonContainer">
                        <label class="block text-xs font-bold text-slate-400 mb-3 uppercase tracking-widest">Growing Season</label>
                        <div class="flex gap-2" id="seasonGroup">
                            <button data-season="Kharif" class="season-btn flex-1 py-2 rounded-xl border border-slate-200 bg-white text-slate-600 text-xs active">Kharif</button>
                            <button data-season="Rabi" class="season-btn flex-1 py-2 rounded-xl border border-slate-200 bg-white text-slate-600 text-xs">Rabi</button>
                            <button data-season="Zaid" class="season-btn flex-1 py-2 rounded-xl border border-slate-200 bg-white text-slate-600 text-xs">Zaid</button>
                        </div>
                    </div>
                </div>

                <!-- Col 3: Results -->
                <div class="bg-slate-900 rounded-[2rem] p-8 text-white flex flex-col justify-center items-center text-center shadow-2xl relative group">
                    <div class="absolute inset-0 bg-gradient-to-br from-white/5 to-transparent rounded-[2rem]"></div>
                    <p class="text-white/40 text-[10px] uppercase tracking-[0.2em] font-bold mb-2">Predicted Yield</p>
                    <div id="predictedResult" class="text-6xl font-black mb-1">4.82</div>
                    <p class="text-white/40 text-[10px] mb-6">TONNES / HECTARE</p>
                    
                    <div class="w-full pt-6 border-t border-white/10">
                         <p class="text-white/40 text-[10px] uppercase font-bold mb-1">Total Expected Output</p>
                         <p id="totalProduction" class="text-2xl font-bold text-white">241.0 Tonnes</p>
                    </div>

                    <button id="runModel" class="mt-8 w-full bg-white text-slate-900 py-4 rounded-2xl text-xs font-black uppercase tracking-widest hover:scale-105 active:scale-95 transition-all shadow-xl">
                        Run Prediction
                    </button>
                </div>
            </div>
        </div>

        <!-- Insight Cards -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div class="glass-card p-6 rounded-3xl border-l-8 border-emerald-500" id="insightCard">
                <h3 class="text-lg font-bold mb-3" id="insightTitle">Tamil Nadu Findings</h3>
                <p id="insightText" class="text-sm text-slate-500 leading-relaxed italic">
                    "Horticultural crops show the highest variance in Tamil Nadu, requiring highly tuned feature sets to capture the impact of climate shifts."
                </p>
            </div>
            <div class="glass-card p-6 rounded-3xl flex items-center justify-between">
                <div>
                    <h3 class="text-sm font-bold mb-1">Policy Ready Implementation</h3>
                    <p class="text-xs text-slate-400">Validated for regional agricultural planning and resource optimization.</p>
                </div>
                <div class="w-12 h-12 rounded-full bg-slate-900 flex items-center justify-center text-white">
                    <i class="fas fa-shield-check"></i>
                </div>
            </div>
        </div>
    </main>

    <script>
        Chart.defaults.font.size = 10;
        Chart.defaults.color = '#94a3b8';

        let currentRegion = 'TN';
        const regionData = {
            TN: {
                acc: '93.87%',
                error: '0.68',
                title: 'Tamil Nadu Multi-Crop Prediction',
                sub: 'Leveraging multi-crop datasets to stabilize food supply in Southern India.',
                crops: [
                    { name: 'Rice', val: 1.0 }, { name: 'Sugarcane', val: 1.2 }, 
                    { name: 'Banana', val: 1.5 }, { name: 'Turmeric', val: 0.9 }
                ],
                insightTitle: 'Tamil Nadu Findings',
                insight: 'Horticultural crops show the highest variance in Tamil Nadu, requiring highly tuned feature sets.',
                driver: 'Annual Rainfall (TN)',
                features: ['Rainfall', 'Area', 'Season', 'Soil'],
                featureWeights: [0.92, 0.78, 0.62, 0.45],
                yieldLine: [4.2, 4.5, 4.3, 4.8, 4.9, 5.1],
                predLine: [4.15, 4.52, 4.28, 4.81, 4.93, 5.08],
                rainLabel: 'Annual Rainfall (mm)',
                rainRange: { min: 400, max: 2500, def: 1100 }
            },
            US: {
                acc: '92.00%',
                error: '1.12',
                title: 'US Corn Belt Yield Analysis',
                sub: 'Modeling historical corn productivity across the US Midwest using climate-specific regressors.',
                crops: [
                    { name: 'Corn (Yellow Dent)', val: 1.1 }, 
                    { name: 'Corn (Sweet)', val: 1.3 },
                    { name: 'Corn (Seed)', val: 1.4 }
                ],
                insightTitle: 'US Corn Belt Insights',
                insight: 'Annual Precipitation and Average Growing Temp are the dominant signals for Midwestern yield stability.',
                driver: 'Precipitation (Midwest)',
                features: ['Precipitation', 'Area', 'Fertilizer', 'Temp'],
                featureWeights: [0.95, 0.72, 0.68, 0.55],
                yieldLine: [9.2, 9.8, 9.1, 10.2, 10.5, 10.8],
                predLine: [9.0, 9.7, 9.3, 10.1, 10.6, 10.7],
                rainLabel: 'Annual Precipitation (mm)',
                rainRange: { min: 200, max: 1500, def: 850 }
            }
        };

        let yieldChart, featureChart;

        function initCharts() {
            const ctxYield = document.getElementById('yieldChart').getContext('2d');
            yieldChart = new Chart(ctxYield, {
                type: 'line',
                data: {
                    labels: ['18', '19', '20', '21', '22', '23'],
                    datasets: [{
                        label: 'Actual',
                        data: regionData.TN.yieldLine,
                        borderColor: '#cbd5e1',
                        borderWidth: 1.5,
                        borderDash: [3, 3],
                        fill: false,
                        pointRadius: 0
                    }, {
                        label: 'XGBoost',
                        data: regionData.TN.predLine,
                        borderColor: '#059669',
                        borderWidth: 2,
                        fill: false,
                        pointRadius: 3
                    }]
                },
                options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } }, scales: { y: { display: false }, x: { grid: { display: false } } } }
            });

            const ctxFeature = document.getElementById('featureChart').getContext('2d');
            featureChart = new Chart(ctxFeature, {
                type: 'bar',
                data: {
                    labels: regionData.TN.features,
                    datasets: [{
                        data: regionData.TN.featureWeights,
                        backgroundColor: '#10b981',
                        borderRadius: 6
                    }]
                },
                options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } }, scales: { x: { grid: { display: false } }, y: { display: false } } }
            });
        }

        function switchRegion(region) {
            currentRegion = region;
            const data = regionData[region];
            const isTN = region === 'TN';

            // Theme Swap
            document.getElementById('bodyTheme').className = isTN ? 'text-slate-800 theme-tn' : 'text-slate-800 theme-us';
            
            // Tab Toggle
            document.getElementById('tabTN').classList.toggle('active', isTN);
            document.getElementById('tabUS').classList.toggle('active', !isTN);
            document.getElementById('tabTN').classList.toggle('text-slate-500', !isTN);
            document.getElementById('tabUS').classList.toggle('text-slate-500', isTN);

            // Metrics Update
            document.getElementById('mainTitle').innerText = data.title;
            document.getElementById('regionSub').innerText = data.sub;
            document.getElementById('statAcc').innerText = data.acc;
            document.getElementById('statError').innerText = data.error;
            document.getElementById('topDriver').innerText = data.driver;
            document.getElementById('insightTitle').innerText = data.insightTitle;
            document.getElementById('insightText').innerText = `"${data.insight}"`;
            document.getElementById('insightCard').style.borderColor = isTN ? '#059669' : '#2563eb';
            
            // UI Label Updates
            document.getElementById('chartSub').innerText = isTN ? 'Tamil Nadu Context' : 'US Corn Context';
            document.getElementById('simRegion').innerText = isTN ? '(Tamil Nadu)' : '(US Corn Belt)';
            document.getElementById('rainLabel').innerText = data.rainLabel;
            
            // Range Update
            const rInput = document.getElementById('rainfallInput');
            rInput.min = data.rainRange.min;
            rInput.max = data.rainRange.max;
            rInput.value = data.rainRange.def;

            // Visibility Toggle for Seasons 
            document.getElementById('seasonContainer').style.opacity = isTN ? '1' : '0.4';
            document.getElementById('seasonContainer').style.pointerEvents = isTN ? 'auto' : 'none';

            // Update Crop List
            const cropSelect = document.getElementById('cropType');
            cropSelect.innerHTML = data.crops.map(c => `<option value="${c.val}">${c.name}</option>`).join('');

            // Update Charts
            yieldChart.data.datasets[1].borderColor = isTN ? '#059669' : '#2563eb';
            yieldChart.data.datasets[0].data = data.yieldLine;
            yieldChart.data.datasets[1].data = data.predLine;
            yieldChart.update();

            featureChart.data.labels = data.features;
            featureChart.data.datasets[0].data = data.featureWeights;
            featureChart.data.datasets[0].backgroundColor = isTN ? '#10b981' : '#3b82f6';
            featureChart.update();

            calculatePrediction();
        }

        const rainfallInput = document.getElementById('rainfallInput');
        const rainfallVal = document.getElementById('rainfallVal');
        const areaInput = document.getElementById('areaInput');
        const seasonBtns = document.querySelectorAll('.season-btn');
        const resultDisplay = document.getElementById('predictedResult');
        const totalProdDisplay = document.getElementById('totalProduction');
        const runBtn = document.getElementById('runModel');

        let activeSeasonMultiplier = 1.1; 

        seasonBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                seasonBtns.forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                const season = btn.dataset.season;
                if(season === 'Kharif') activeSeasonMultiplier = 1.1;
                else if(season === 'Rabi') activeSeasonMultiplier = 1.0;
                else activeSeasonMultiplier = 0.8;
                calculatePrediction();
            });
        });

        function calculatePrediction() {
            const rainfall = parseFloat(rainfallInput.value);
            const area = parseFloat(areaInput.value) || 0;
            const cropTypeSelect = document.getElementById('cropType');
            const cropMult = parseFloat(cropTypeSelect.value || 1.0);
            
            rainfallVal.innerText = rainfall + 'mm';

            const isTN = currentRegion === 'TN';
            const baseYield = isTN ? 2.5 : 9.0;
            const rainFactor = (rainfall / (isTN ? 1000 : 700));
            const seasonFactor = isTN ? activeSeasonMultiplier : 1.0;
            
            const predictedYield = ((baseYield + rainFactor) * cropMult * seasonFactor).toFixed(2);
            const totalProduction = (parseFloat(predictedYield) * area).toFixed(1);

            resultDisplay.innerText = predictedYield;
            totalProdDisplay.innerText = totalProduction + " Tonnes";
        }

        rainfallInput.addEventListener('input', calculatePrediction);
        areaInput.addEventListener('input', calculatePrediction);
        document.getElementById('cropType').addEventListener('change', calculatePrediction);
        
        window.onload = () => {
            initCharts();
            switchRegion('TN'); 
        };

        runBtn.addEventListener('click', () => {
            runBtn.innerText = "Processing...";
            resultDisplay.classList.add('opacity-50');
            setTimeout(() => {
                calculatePrediction();
                runBtn.innerText = "Run Prediction";
                resultDisplay.classList.remove('opacity-50');
            }, 600);
        });
    </script>
</body>
</html>